<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CondoSaas - Multi-Condomínio</title>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root { --primary: #2E7D32; --bg: #f5f5f5; --white: #fff; --super: #6200EA; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; }
        body { background-color: var(--bg); color: #333; padding-bottom: 80px; min-height: 100vh; }
        
        /* Layout Geral */
        .app-bar { background: var(--primary); color: white; padding: 16px; position: sticky; top: 0; z-index: 100; display: flex; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .app-bar.super { background: var(--super); } /* Cor diferente para Super Usuário */
        .app-title { font-size: 1.2rem; font-weight: 500; margin-left: 12px; flex: 1; }
        .container { max-width: 1000px; margin: 16px auto; padding: 0 16px; }
        
        /* Cards & UI */
        .card { background: var(--white); border-radius: 8px; padding: 16px; margin-bottom: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .btn { padding: 10px 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; display: inline-flex; align-items: center; justify-content: center; gap: 6px; transition: 0.2s; font-size: 0.9rem; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-super { background: var(--super); color: white; }
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        .btn-danger { background: transparent; border: 1px solid #D32F2F; color: #D32F2F; }
        
        /* Login Screen */
        .login-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80vh; padding: 20px; }
        .login-card { width: 100%; max-width: 400px; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        /* Forms */
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; margin-bottom: 6px; font-weight: 500; font-size: 0.9rem; color: #555; }
        .form-control { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; }
        
        /* Calendário Customizado (Simplificado) */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .week-day { text-align: center; font-size: 0.8rem; color: #666; padding: 8px 0; }
        .day-cell { aspect-ratio: 1; background: #fff; border: 1px solid #eee; border-radius: 4px; display: flex; flex-direction: column; padding: 4px; cursor: pointer; position: relative; }
        .day-cell.today { border: 2px solid var(--primary); }
        .day-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--primary); margin: 2px; }
        .dots-container { display: flex; flex-wrap: wrap; gap: 2px; margin-top: 4px; }
        .day-number { font-size: 0.9rem; font-weight: bold; }
        
        /* Toasts */
        .toast-container { position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast { background: #333; color: white; padding: 12px 20px; border-radius: 4px; animation: slideIn 0.3s; display: flex; align-items: center; gap: 10px; }
        .toast.success { border-left: 4px solid #4CAF50; }
        .toast.error { border-left: 4px solid #F44336; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        /* Badge Status */
        .badge { padding: 4px 8px; border-radius: 12px; font-size: 0.75rem; text-transform: uppercase; font-weight: bold; }
        .badge.pending { background: #E3F2FD; color: #1976D2; }
        .badge.approved { background: #E8F5E9; color: #2E7D32; }
        .badge.rejected { background: #FFEBEE; color: #C62828; }
        
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 2000; }
        .modal-content { background: white; padding: 24px; border-radius: 8px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; height: 60px; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #eee; z-index: 90; }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #999; font-size: 0.7rem; cursor: pointer; }
        .nav-item.active { color: var(--primary); transform: translateY(-2px); }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="app">
        <div class="toast-container">
            <div v-for="(t, i) in toasts" :key="i" class="toast" :class="t.type">
                <i class="material-icons">{{ t.type === 'success' ? 'check_circle' : 'error' }}</i>
                {{ t.message }}
            </div>
        </div>

        <div v-if="!currentUser" class="login-container">
            <div class="login-card">
                <div style="text-align: center; margin-bottom: 20px;">
                    <i class="material-icons" style="font-size: 48px; color: var(--primary);">apartment</i>
                    <h2>CondoSaas</h2>
                    <p style="color: #666;">Gestão Inteligente de Condomínios</p>
                </div>

                <form @submit.prevent="handleLogin">
                    <div class="form-group">
                        <label class="form-label">E-mail</label>
                        <input type="email" v-model="authForm.email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Senha</label>
                        <input type="password" v-model="authForm.password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;" :disabled="loading">
                        {{ loading ? 'Entrando...' : 'Entrar' }}
                    </button>
                </form>
                
                <div v-if="isRegistering" style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee;">
                    <h4 style="margin-bottom: 10px;">Novo Condomínio?</h4>
                    <p style="font-size: 0.9rem; color: #666;">Entre em contato com o suporte para cadastrar seu condomínio.</p>
                </div>
            </div>
        </div>

        <div v-else>
            <div class="app-bar" :class="{ 'super': currentUser.type === 'superuser' }">
                <i class="material-icons">{{ currentUser.type === 'superuser' ? 'admin_panel_settings' : 'apartment' }}</i>
                <span class="app-title">
                    {{ currentUser.type === 'superuser' ? 'Painel Administrativo' : condoName }}
                </span>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="text-align: right; font-size: 0.8rem; line-height: 1.2;">
                        <div>{{ currentUser.name }}</div>
                        <div style="opacity: 0.8;">{{ getRoleLabel(currentUser.type) }}</div>
                    </div>
                    <button class="btn" style="background: rgba(255,255,255,0.2); padding: 6px;" @click="logout">
                        <i class="material-icons">logout</i>
                    </button>
                </div>
            </div>

            <div class="container">
                
                <div v-if="currentUser.type === 'superuser'">
                    <div class="card">
                        <h3>Cadastrar Novo Condomínio</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 15px;">Crie um novo ambiente e defina o primeiro síndico.</p>
                        
                        <div class="form-group">
                            <label class="form-label">Nome do Condomínio</label>
                            <input type="text" v-model="newCondo.name" class="form-control" placeholder="Ex: Edifício Solar">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Endereço</label>
                            <input type="text" v-model="newCondo.address" class="form-control" placeholder="Rua das Flores, 123">
                        </div>
                        
                        <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">
                        <h4 style="margin-bottom: 10px;">Dados do Síndico Inicial</h4>
                        
                        <div class="form-group">
                            <label class="form-label">Nome do Síndico</label>
                            <input type="text" v-model="newCondo.syndicName" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="form-label">E-mail do Síndico (Login)</label>
                            <input type="email" v-model="newCondo.syndicEmail" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Senha Inicial</label>
                            <input type="text" v-model="newCondo.syndicPassword" class="form-control" placeholder="Mínimo 6 caracteres">
                        </div>

                        <button class="btn btn-super" @click="createCondo" :disabled="loading" style="width: 100%;">
                            {{ loading ? 'Criando...' : 'Cadastrar Condomínio & Síndico' }}
                        </button>
                    </div>

                    <h3>Condomínios Ativos</h3>
                    <div v-for="c in condoList" :key="c.id" class="card" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>{{ c.name }}</strong>
                            <div style="font-size: 0.8rem; color: #666;">{{ c.address }}</div>
                        </div>
                        <span class="badge approved">Ativo</span>
                    </div>
                </div>

                <div v-else>
                    
                    <div v-if="currentView === 'calendar'">
                        <div class="card">
                            <div class="calendar-header">
                                <button class="btn btn-outline" @click="changeMonth(-1)"><i class="material-icons">chevron_left</i></button>
                                <h3>{{ monthLabel }}</h3>
                                <button class="btn btn-outline" @click="changeMonth(1)"><i class="material-icons">chevron_right</i></button>
                            </div>
                            <div class="calendar-grid">
                                <div class="week-day" v-for="d in ['D','S','T','Q','Q','S','S']">{{ d }}</div>
                                <div v-for="n in paddingDays" class="day-cell empty"></div>
                                <div v-for="day in daysInMonth" class="day-cell" :class="{ 'today': isToday(day) }" @click="selectDate(day)">
                                    <span class="day-number">{{ day }}</span>
                                    <div class="dots-container">
                                        <div v-for="res in getReservationsForDay(day)" class="day-dot" :style="{ background: getStatusColor(res.status) }"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3>Espaços Disponíveis</h3>
                            <div v-for="space in spaces" :key="space.id" style="border-bottom: 1px solid #eee; padding: 15px 0; display: flex; align-items: center; gap: 15px;">
                                <div :style="{backgroundImage: 'url('+space.image+')'}" style="width: 50px; height: 50px; background-size: cover; border-radius: 8px;"></div>
                                <div style="flex: 1;">
                                    <strong>{{ space.name }}</strong>
                                    <div style="font-size: 0.8rem; color: #666;">Capacidade: {{ space.capacity }}</div>
                                </div>
                                <button class="btn btn-primary" @click="openBookingModal(space)">Reservar</button>
                            </div>
                        </div>
                    </div>

                    <div v-if="currentView === 'reservations'">
                        <h2>Minhas Reservas</h2>
                        <div v-if="myReservations.length === 0" style="padding: 30px; text-align: center; color: #999;">Nenhuma reserva.</div>
                        <div v-for="res in myReservations" :key="res.id" class="card">
                            <div style="display: flex; justify-content: space-between;">
                                <strong>{{ getSpaceName(res.spaceId) }}</strong>
                                <span class="badge" :class="res.status">{{ res.status }}</span>
                            </div>
                            <p style="color: #666;">{{ formatDate(res.date) }} às {{ res.time }}</p>
                            <div v-if="res.status === 'pending'" style="margin-top: 10px;">
                                <button class="btn btn-danger" @click="deleteReservation(res.id)">Cancelar</button>
                            </div>
                        </div>
                    </div>

                    <div v-if="currentView === 'admin'">
                        <h2>Gerenciar Reservas</h2>
                        <div v-if="currentUser.type !== 'syndic'" style="color: red;">Acesso restrito.</div>
                        <div v-else>
                            <div v-if="pendingReservations.length === 0" style="padding: 20px; color: #999;">Nenhuma pendência.</div>
                            <div v-for="res in pendingReservations" :key="res.id" class="card" style="border-left: 4px solid #2196F3;">
                                <strong>{{ getSpaceName(res.spaceId) }}</strong>
                                <div style="font-size: 0.9rem;">{{ res.userName }} - {{ formatDate(res.date) }}</div>
                                <div style="margin-top: 10px; display: flex; gap: 10px;">
                                    <button class="btn btn-primary" style="flex: 1;" @click="updateStatus(res.id, 'approved')">Aprovar</button>
                                    <button class="btn btn-danger" style="flex: 1;" @click="updateStatus(res.id, 'rejected')">Rejeitar</button>
                                </div>
                            </div>
                        </div>

                        <div class="card" style="margin-top: 20px;">
                            <h3>Cadastrar Novo Morador</h3>
                            <div class="form-group">
                                <label class="form-label">Nome</label>
                                <input type="text" v-model="newResident.name" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">E-mail</label>
                                <input type="email" v-model="newResident.email" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Senha Provisória</label>
                                <input type="text" v-model="newResident.password" class="form-control">
                            </div>
                            <button class="btn btn-primary" @click="createResident" style="width: 100%;">Cadastrar Morador</button>
                        </div>
                    </div>

                </div>
            </div>

            <div v-if="currentUser.type !== 'superuser'" class="bottom-nav">
                <div class="nav-item" :class="{active: currentView === 'calendar'}" @click="currentView = 'calendar'"><i class="material-icons">calendar_month</i></div>
                <div class="nav-item" :class="{active: currentView === 'reservations'}" @click="currentView = 'reservations'"><i class="material-icons">receipt_long</i></div>
                <div v-if="currentUser.type === 'syndic'" class="nav-item" :class="{active: currentView === 'admin'}" @click="currentView = 'admin'"><i class="material-icons">verified_user</i></div>
            </div>
        </div>

        <div class="modal-overlay" v-if="showModal" @click.self="showModal = false">
            <div class="modal-content">
                <h3>Reservar {{ selectedSpace?.name }}</h3>
                <div class="form-group">
                    <label class="form-label">Data</label>
                    <input type="date" v-model="form.date" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label">Horário</label>
                    <select v-model="form.time" class="form-control">
                        <option>08:00 - 12:00</option>
                        <option>13:00 - 17:00</option>
                        <option>18:00 - 22:00</option>
                    </select>
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                    <button class="btn btn-outline" @click="showModal = false">Cancelar</button>
                    <button class="btn btn-primary" @click="confirmBooking" :disabled="loading">Confirmar</button>
                </div>
            </div>
        </div>

    </div>

    <script type="module">
        import { createApp, ref, computed, onMounted } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js';
        
        // FIREBASE
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy, where, getDoc, setDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // SUAS CHAVES AQUI (MANTENHA AS MESMAS)
        const firebaseConfig = {
            apiKey: "AIzaSyDeWvVtINqz07UK-iCZwG8-rfBJN7insDM",
            authDomain: "condosaas-app.firebaseapp.com",
            projectId: "condosaas-app",
            storageBucket: "condosaas-app.firebasestorage.app",
            messagingSenderId: "1094942324011",
            appId: "1:1094942324011:web:49293ce94269e71807416e"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        createApp({
            setup() {
                // Estado
                const currentView = ref('calendar');
                const currentUser = ref(null);
                const condoName = ref('Carregando...');
                const condoList = ref([]);
                const reservations = ref([]);
                const loading = ref(false);
                const toasts = ref([]);
                
                // Forms
                const authForm = ref({ email: '', password: '' });
                const newCondo = ref({ name: '', address: '', syndicName: '', syndicEmail: '', syndicPassword: '' });
                const newResident = ref({ name: '', email: '', password: '' });
                const form = ref({ date: '', time: '13:00 - 17:00' });
                const showModal = ref(false);
                const selectedSpace = ref(null);

                // Dados Estáticos de Espaços
                const spaces = ref([
                    { id: 'esp_1', name: 'Salão de Festas', capacity: 50, image: 'https://images.unsplash.com/photo-1519167758481-83f550bb49b3?w=200' },
                    { id: 'esp_2', name: 'Churrasqueira', capacity: 20, image: 'https://images.unsplash.com/photo-1555244162-803834f70033?w=200' }
                ]);

                // --- AUTH LOGIC ---
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        try {
                            // Busca dados do usuário E do condomínio
                            const userDoc = await getDoc(doc(db, "users", user.uid));
                            if (userDoc.exists()) {
                                const userData = userDoc.data();
                                currentUser.value = { uid: user.uid, email: user.email, ...userData };
                                
                                if (userData.type === 'superuser') {
                                    loadSuperUserData();
                                } else {
                                    loadCondoData(userData.condoId);
                                }
                            }
                        } catch (e) { console.error(e); }
                    } else {
                        currentUser.value = null;
                        reservations.value = [];
                    }
                });

                const handleLogin = async () => {
                    loading.value = true;
                    try {
                        await signInWithEmailAndPassword(auth, authForm.value.email, authForm.value.password);
                        showToast("Bem-vindo!");
                    } catch (e) { showToast("Login inválido", "error"); }
                    finally { loading.value = false; }
                };

                const logout = async () => await signOut(auth);

                // --- LOGICA MULTI-TENANT ---
                
                // Carrega reservas APENAS do condomínio do usuário
                const loadCondoData = async (condoId) => {
                    // Busca nome do condomínio
                    const condoDoc = await getDoc(doc(db, "condominios", condoId));
                    if (condoDoc.exists()) condoName.value = condoDoc.data().name;

                    // Listener Realtime Filtrado
                    const q = query(collection(db, "reservations"), where("condoId", "==", condoId));
                    onSnapshot(q, (snapshot) => {
                        reservations.value = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                    });
                };

                // Carrega lista de condomínios para o SuperUser
                const loadSuperUserData = () => {
                    onSnapshot(collection(db, "condominios"), (snapshot) => {
                        condoList.value = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                    });
                };

                // --- AÇÕES DO SUPER USUÁRIO ---
                const createCondo = async () => {
                    if(!newCondo.value.name || !newCondo.value.syndicEmail) return showToast("Preencha tudo", "error");
                    
                    loading.value = true;
                    try {
                        // 1. Criar Condomínio
                        const condoRef = await addDoc(collection(db, "condominios"), {
                            name: newCondo.value.name,
                            address: newCondo.value.address,
                            createdAt: new Date().toISOString()
                        });

                        // 2. Criar Usuário Síndico (Auth + Firestore)
                        // NOTA: Em produção, criação de usuário secundário deve ser via Cloud Functions para não deslogar o admin.
                        // Para este MVP Single File, vamos simular a criação criando o doc no Firestore e pedindo pro usuário criar no Auth depois ou usando app secundário.
                        // TRUQUE DO MVP: Vamos criar o Auth agora. Isso vai deslogar o SuperUser. É o comportamento esperado client-side.
                        
                        const userCred = await createUserWithEmailAndPassword(auth, newCondo.value.syndicEmail, newCondo.value.syndicPassword);
                        
                        // Vincula Síndico ao Condomínio Criado
                        await setDoc(doc(db, "users", userCred.user.uid), {
                            name: newCondo.value.syndicName,
                            email: newCondo.value.syndicEmail,
                            type: 'syndic',
                            condoId: condoRef.id // <--- O VÍNCULO MÁGICO
                        });

                        alert("Condomínio criado! Você foi logado como o novo síndico para testar. Faça logout para voltar ao SuperUser.");
                        // Recarrega página
                        window.location.reload();

                    } catch (e) { showToast("Erro: " + e.message, "error"); }
                    finally { loading.value = false; }
                };

                // --- AÇÕES DO SÍNDICO (CRIAR MORADOR) ---
                const createResident = async () => {
                    // Mesmo problema de client-side auth: criar outro user desloga o atual.
                    // Solução ideal: Cloud Function. 
                    // Solução MVP: Avisar o síndico.
                    if(!confirm("Ao criar um morador, você será deslogado e logado como ele para ativar a conta. Continuar?")) return;
                    
                    try {
                        const userCred = await createUserWithEmailAndPassword(auth, newResident.value.email, newResident.value.password);
                        await setDoc(doc(db, "users", userCred.user.uid), {
                            name: newResident.value.name,
                            email: newResident.value.email,
                            type: 'resident',
                            condoId: currentUser.value.condoId // Herda o condomínio do síndico
                        });
                        alert("Morador criado! Você está logado como ele agora.");
                        window.location.reload();
                    } catch (e) { showToast("Erro: " + e.message, "error"); }
                };

                // --- RESERVAS ---
                const openBookingModal = (space) => { selectedSpace.value = space; showModal.value = true; };
                
                const confirmBooking = async () => {
                    loading.value = true;
                    try {
                        await addDoc(collection(db, "reservations"), {
                            condoId: currentUser.value.condoId, // <--- IMPORTANTE: Vínculo da reserva
                            spaceId: selectedSpace.value.id,
                            userId: currentUser.value.uid,
                            userName: currentUser.value.name,
                            date: form.value.date,
                            time: form.value.time,
                            status: 'pending'
                        });
                        showModal.value = false;
                        showToast("Solicitação enviada!");
                    } catch(e) { showToast("Erro", "error"); }
                    finally { loading.value = false; }
                };

                const updateStatus = async (id, status) => {
                    await updateDoc(doc(db, "reservations", id), { status });
                };

                // --- HELPERS ---
                const showToast = (msg, type='success') => { toasts.value.push({message: msg, type}); setTimeout(()=>toasts.value.shift(), 3000); };
                const getRoleLabel = (t) => ({'superuser':'Administrador Geral','syndic':'Síndico','resident':'Morador'})[t] || t;
                const getSpaceName = (id) => spaces.value.find(s=>s.id===id)?.name || 'Espaço';
                const getStatusColor = (s) => s==='approved'?'#4CAF50':s==='pending'?'#2196F3':'#F44336';
                const formatDate = (d) => d?.split('-').reverse().join('/');
                
                // Computeds
                const myReservations = computed(() => reservations.value.filter(r => r.userId === currentUser.value?.uid));
                const pendingReservations = computed(() => reservations.value.filter(r => r.status === 'pending'));
                
                // Calendar Helpers
                const currentDate = ref(new Date());
                const monthLabel = computed(() => currentDate.value.toLocaleString('pt-BR', { month: 'long', year: 'numeric' }));
                const daysInMonth = computed(() => new Date(currentDate.value.getFullYear(), currentDate.value.getMonth() + 1, 0).getDate());
                const paddingDays = computed(() => new Date(currentDate.value.getFullYear(), currentDate.value.getMonth(), 1).getDay());
                const changeMonth = (d) => currentDate.value = new Date(currentDate.value.setMonth(currentDate.value.getMonth() + d));
                const isToday = (d) => d === new Date().getDate() && currentDate.value.getMonth() === new Date().getMonth();
                const getReservationsForDay = (d) => {
                    const dt = `${currentDate.value.getFullYear()}-${String(currentDate.value.getMonth()+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                    return reservations.value.filter(r => r.date === dt && r.status !== 'rejected');
                };

                return {
                    authForm, handleLogin, logout, currentUser, condoName, loading, toasts,
                    condoList, newCondo, createCondo, newResident, createResident,
                    currentView, spaces, reservations, myReservations, pendingReservations,
                    showModal, form, openBookingModal, confirmBooking, updateStatus,
                    monthLabel, daysInMonth, paddingDays, changeMonth, isToday, getReservationsForDay, getStatusColor,
                    getRoleLabel, getSpaceName, formatDate
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
