<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CondoSaas - Sistema de Reservas</title>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root { --primary: #2E7D32; --bg: #f5f5f5; --white: #fff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; }
        body { background-color: var(--bg); color: #333; padding-bottom: 80px; }
        
        /* Layout */
        .app-bar { background: var(--primary); color: white; padding: 16px; position: sticky; top: 0; z-index: 100; display: flex; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .app-title { font-size: 1.2rem; font-weight: 500; margin-left: 12px; flex: 1; }
        .container { max-width: 1000px; margin: 16px auto; padding: 0 16px; }
        
        /* Cards & Buttons */
        .card { background: var(--white); border-radius: 8px; padding: 16px; margin-bottom: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .btn { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; display: inline-flex; align-items: center; gap: 6px; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { opacity: 0.9; }
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        .btn-text { background: transparent; color: white; border: 1px solid rgba(255,255,255,0.3); font-size: 0.85rem; }

        /* Calendário Customizado */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .week-day { text-align: center; font-size: 0.8rem; color: #666; padding: 8px 0; }
        .day-cell { 
            aspect-ratio: 1; background: #fff; border: 1px solid #eee; border-radius: 4px; 
            display: flex; flex-direction: column; justify-content: flex-start; padding: 4px; cursor: pointer; position: relative;
        }
        .day-cell:hover { background: #f0f0f0; }
        .day-cell.empty { background: transparent; border: none; cursor: default; }
        .day-number { font-size: 0.9rem; font-weight: bold; }
        .day-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--primary); margin: 2px; }
        .dots-container { display: flex; flex-wrap: wrap; gap: 2px; margin-top: 4px; }
        .day-cell.today { border: 2px solid var(--primary); }

        /* Toasts (Notificações) */
        .toast-container { position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast { background: #333; color: white; padding: 12px 20px; border-radius: 4px; animation: slideIn 0.3s; display: flex; align-items: center; gap: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .toast.success { border-left: 4px solid #4CAF50; }
        .toast.error { border-left: 4px solid #F44336; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        /* Utilitários */
        .badge { padding: 4px 8px; border-radius: 12px; font-size: 0.75rem; text-transform: uppercase; font-weight: bold; }
        .badge.pending { background: #E3F2FD; color: #1976D2; }
        .badge.approved { background: #E8F5E9; color: #2E7D32; }
        .badge.rejected { background: #FFEBEE; color: #C62828; }
        .form-group { margin-bottom: 12px; }
        .form-control { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 2000; }
        .modal-content { background: white; padding: 24px; border-radius: 8px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        
        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; height: 60px; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #eee; z-index: 90; }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #999; font-size: 0.7rem; cursor: pointer; transition: 0.2s; }
        .nav-item.active { color: var(--primary); transform: translateY(-2px); }
        .nav-item i { font-size: 24px; margin-bottom: 2px; }
    </style>
</head>
<body>

    <div id="app">
        <div class="toast-container">
            <div v-for="(t, i) in toasts" :key="i" class="toast" :class="t.type">
                <i class="material-icons">{{ t.type === 'success' ? 'check_circle' : 'error' }}</i>
                {{ t.message }}
            </div>
        </div>

        <div class="app-bar">
            <i class="material-icons">apartment</i>
            <span class="app-title">CondoSaas</span>
            <button class="btn btn-text" @click="toggleUser">
                <i class="material-icons" style="font-size: 18px; margin-right: 4px;">{{ currentUser.type === 'syndic' ? 'admin_panel_settings' : 'person' }}</i>
                {{ currentUser.type === 'syndic' ? 'Síndico' : 'Morador' }}
            </button>
        </div>

        <div class="container">
            
            <div v-if="currentView === 'calendar'">
                <div class="card">
                    <div class="calendar-header">
                        <button class="btn btn-outline" @click="changeMonth(-1)"><i class="material-icons">chevron_left</i></button>
                        <h3 style="text-transform: capitalize;">{{ monthLabel }}</h3>
                        <button class="btn btn-outline" @click="changeMonth(1)"><i class="material-icons">chevron_right</i></button>
                    </div>
                    
                    <div class="calendar-grid">
                        <div class="week-day" v-for="d in ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb']">{{ d }}</div>
                        
                        <div v-for="n in paddingDays" :key="'pad-'+n" class="day-cell empty"></div>
                        
                        <div v-for="day in daysInMonth" :key="day" 
                             class="day-cell" 
                             :class="{ 'today': isToday(day) }"
                             @click="selectDate(day)">
                            <span class="day-number">{{ day }}</span>
                            <div class="dots-container">
                                <div v-for="res in getReservationsForDay(day)" :key="res.id" 
                                     class="day-dot" 
                                     :style="{ background: getStatusColor(res.status) }"
                                     :title="res.status">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.8rem; color: #666; display: flex; gap: 15px; justify-content: center;">
                        <span style="display:flex; align-items:center;"><div class="day-dot" style="background:#4CAF50; margin-right:4px;"></div> Aprovado</span>
                        <span style="display:flex; align-items:center;"><div class="day-dot" style="background:#2196F3; margin-right:4px;"></div> Pendente</span>
                    </div>
                </div>

                <div class="card">
                    <h3>Espaços Disponíveis</h3>
                    <div v-for="space in spaces" :key="space.id" style="border-bottom: 1px solid #eee; padding: 15px 0; display: flex; gap: 15px; align-items: center;">
                        <div :style="{backgroundImage: 'url('+space.image+')'}" style="width: 60px; height: 60px; background-size: cover; border-radius: 8px;"></div>
                        <div style="flex: 1;">
                            <strong>{{ space.name }}</strong>
                            <div style="font-size: 0.9rem; color: #666;">
                                <i class="material-icons" style="font-size: 14px; vertical-align: text-bottom;">group</i> {{ space.capacity }} • R$ {{ space.hourlyRate }}/h
                            </div>
                        </div>
                        <button class="btn btn-primary" @click="openBookingModal(space)">Reservar</button>
                    </div>
                </div>
            </div>

            <div v-if="currentView === 'reservations'">
                <h2>Minhas Reservas</h2>
                <div v-if="myReservations.length === 0" style="text-align: center; padding: 40px; color: #999;">
                    <i class="material-icons" style="font-size: 48px; margin-bottom: 10px;">event_busy</i>
                    <p>Você ainda não possui reservas.</p>
                    <button class="btn btn-outline" style="margin-top: 10px;" @click="currentView = 'calendar'">Fazer Reserva</button>
                </div>

                <div v-for="res in myReservations" :key="res.id" class="card">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <strong>{{ getSpaceName(res.spaceId) }}</strong>
                        <span class="badge" :class="res.status">{{ translateStatus(res.status) }}</span>
                    </div>
                    <p style="display: flex; align-items: center; gap: 5px; color: #555;">
                        <i class="material-icons" style="font-size: 18px;">calendar_today</i>
                        {{ formatDate(res.date) }} às {{ res.time }}
                    </p>
                    
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #eee; display: flex; gap: 8px;">
                        <button v-if="res.status === 'approved'" class="btn btn-outline" @click="generateReceipt(res)">
                            <i class="material-icons">description</i> Comprovante
                        </button>
                        <button v-if="res.status === 'pending'" class="btn btn-outline" style="color: #D32F2F; border-color: #D32F2F;" @click="deleteReservation(res.id)">
                            Cancelar
                        </button>
                    </div>
                </div>
            </div>

            <div v-if="currentView === 'admin'">
                <h2>Painel do Síndico</h2>
                <div class="card">
                    <div style="display: flex; gap: 20px; text-align: center;">
                        <div style="flex: 1; border-right: 1px solid #eee;">
                            <div style="font-size: 2rem; color: #2196F3; font-weight: bold;">{{ pendingReservations.length }}</div>
                            <div style="font-size: 0.8rem; text-transform: uppercase; color: #666;">Pendentes</div>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-size: 2rem; color: #4CAF50; font-weight: bold;">{{ approvedReservations.length }}</div>
                            <div style="font-size: 0.8rem; text-transform: uppercase; color: #666;">Aprovadas</div>
                        </div>
                    </div>
                </div>

                <h3 style="margin-bottom: 10px;">Solicitações Recentes</h3>
                <div v-if="pendingReservations.length === 0" style="padding: 20px; text-align: center; color: #999; background: white; border-radius: 8px;">
                    <i class="material-icons">check</i> Nenhuma solicitação pendente!
                </div>
                
                <div v-for="res in pendingReservations" :key="res.id" class="card" style="border-left: 4px solid #2196F3;">
                    <div style="display: flex; justify-content: space-between;">
                        <strong>{{ getSpaceName(res.spaceId) }}</strong>
                        <span style="font-size: 0.8rem; color: #666;">{{ formatDate(res.date) }}</span>
                    </div>
                    <div style="margin: 5px 0; color: #444;">Morador: {{ getUserName(res.userId) }}</div>
                    <div style="font-size: 0.9rem; color: #666;">Horário: {{ res.time }} • {{ res.guests }} convidados</div>
                    
                    <div style="margin-top: 12px; display: flex; gap: 10px;">
                        <button class="btn btn-primary" style="flex: 1;" @click="updateStatus(res.id, 'approved')">Aprovar</button>
                        <button class="btn btn-outline" style="flex: 1; color: #D32F2F; border-color: #D32F2F" @click="updateStatus(res.id, 'rejected')">Rejeitar</button>
                    </div>
                </div>
            </div>

        </div>

        <div class="bottom-nav">
            <div class="nav-item" :class="{active: currentView === 'calendar'}" @click="currentView = 'calendar'">
                <i class="material-icons">calendar_month</i>Início
            </div>
            <div class="nav-item" :class="{active: currentView === 'reservations'}" @click="currentView = 'reservations'">
                <i class="material-icons">receipt_long</i>Reservas
            </div>
            <div v-if="currentUser.type === 'syndic'" class="nav-item" :class="{active: currentView === 'admin'}" @click="currentView = 'admin'">
                <i class="material-icons">verified_user</i>Síndico
            </div>
        </div>

        <div class="modal-overlay" v-if="showModal" @click.self="showModal = false">
            <div class="modal-content">
                <h3>Reservar {{ selectedSpace?.name }}</h3>
                <div class="form-group">
                    <label>Data da Reserva</label>
                    <input type="date" v-model="form.date" class="form-control">
                </div>
                <div class="form-group">
                    <label>Horário</label>
                    <select v-model="form.time" class="form-control">
                        <option>08:00 - 12:00</option>
                        <option>13:00 - 17:00</option>
                        <option>18:00 - 22:00</option>
                        <option>10:00 - 16:00 (Festa)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Número de Convidados (Max: {{ selectedSpace?.capacity }})</label>
                    <input type="number" v-model="form.guests" class="form-control" :max="selectedSpace?.capacity">
                </div>
                
                <div style="background: #f0f8ff; padding: 10px; border-radius: 4px; margin: 15px 0; font-size: 0.9rem;">
                    <strong>Valor Estimado:</strong> R$ {{ calculateTotal }}
                </div>

                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                    <button class="btn btn-outline" @click="showModal = false">Cancelar</button>
                    <button class="btn btn-primary" @click="confirmBooking" :disabled="loading" style="min-width: 100px;">
                        <span v-if="loading" style="display:inline-block; animation: spin 1s linear infinite;">↻</span>
                        {{ loading ? 'Enviando...' : 'Confirmar' }}
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script type="module">
        import { createApp, ref, computed, onMounted } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js';
        
        // --- CONFIGURAÇÃO DO FIREBASE ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // SUAS CHAVES AQUI
        const firebaseConfig = {
            apiKey: "AIzaSyDeWvVtINqz07UK-iCZwG8-rfBJN7insDM",
            authDomain: "condosaas-app.firebaseapp.com",
            projectId: "condosaas-app",
            storageBucket: "condosaas-app.firebasestorage.app",
            messagingSenderId: "1094942324011",
            appId: "1:1094942324011:web:49293ce94269e71807416e"
        };

        // Inicializa Firebase
        let db;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            console.log("Firebase conectado com sucesso ao projeto condosaas-app!");
        } catch (e) {
            console.error("Erro na conexão Firebase:", e);
        }

        createApp({
            setup() {
                // Estado da Aplicação
                const currentView = ref('calendar');
                const reservations = ref([]);
                const loading = ref(false);
                const toasts = ref([]);
                
                // Usuário Mockado (Simulação de Login para MVP)
                const currentUser = ref({ id: 'user_123', name: 'João Silva', type: 'resident', apartment: '101 Bloco A' });
                
                // Base de usuários fictícia para o Síndico identificar quem reservou
                const usersList = [
                    { id: 'user_123', name: 'João Silva', type: 'resident' },
                    { id: 'admin_001', name: 'Maria Síndica', type: 'syndic' },
                    { id: 'user_456', name: 'Carlos Vizinho', type: 'resident' }
                ];

                // Espaços do Condomínio (Dados Estáticos)
                const spaces = ref([
                    { id: 'esp_1', name: 'Salão de Festas', capacity: 50, hourlyRate: 80, image: 'https://images.unsplash.com/photo-1519167758481-83f550bb49b3?w=200&q=80' },
                    { id: 'esp_2', name: 'Churrasqueira Gourmet', capacity: 20, hourlyRate: 30, image: 'https://images.unsplash.com/photo-1555244162-803834f70033?w=200&q=80' },
                    { id: 'esp_3', name: 'Quadra Poliesportiva', capacity: 30, hourlyRate: 15, image: 'https://images.unsplash.com/photo-1546519638-68e109498ffc?w=200&q=80' }
                ]);

                // Lógica do Calendário
                const currentDate = ref(new Date());
                const monthLabel = computed(() => currentDate.value.toLocaleString('pt-BR', { month: 'long', year: 'numeric' }));
                
                const daysInMonth = computed(() => {
                    const year = currentDate.value.getFullYear();
                    const month = currentDate.value.getMonth();
                    return new Date(year, month + 1, 0).getDate();
                });

                const paddingDays = computed(() => {
                    const year = currentDate.value.getFullYear();
                    const month = currentDate.value.getMonth();
                    return new Date(year, month, 1).getDay();
                });

                // --- LISTENERS REALTIME DO FIREBASE ---
                onMounted(() => {
                    if (!db) {
                        showToast("Erro: Banco de dados não configurado.", "error");
                        return;
                    }
                    
                    // Escuta a coleção 'reservations' ordenando por data
                    try {
                        const q = query(collection(db, "reservations"), orderBy("date"));
                        
                        onSnapshot(q, (snapshot) => {
                            reservations.value = snapshot.docs.map(doc => ({
                                id: doc.id,
                                ...doc.data()
                            }));
                        }, (error) => {
                            console.error("Erro ao ler dados:", error);
                            showToast("Permissão negada. Verifique as Regras do Firestore.", "error");
                        });
                    } catch (e) {
                        console.error("Erro query:", e);
                    }
                });

                // --- AÇÕES DO SISTEMA ---

                // Toast Notification
                const showToast = (message, type = 'success') => {
                    toasts.value.push({ message, type });
                    setTimeout(() => toasts.value.shift(), 4000);
                };

                // Abrir Modal de Reserva
                const showModal = ref(false);
                const selectedSpace = ref(null);
                const form = ref({ date: '', time: '13:00 - 17:00', guests: 10 });

                const openBookingModal = (space) => {
                    selectedSpace.value = space;
                    // Define data padrão como hoje ou dia selecionado
                    const year = currentDate.value.getFullYear();
                    const month = String(currentDate.value.getMonth() + 1).padStart(2, '0');
                    const day = String(new Date().getDate()).padStart(2, '0');
                    form.value.date = `${year}-${month}-${day}`;
                    showModal.value = true;
                };

                // Confirmar e Enviar para Firebase
                const confirmBooking = async () => {
                    if (!db) return;
                    if (!form.value.date) return showToast("Selecione uma data válida", "error");
                    
                    // Validação simples de conflito (apenas frontend por enquanto)
                    const conflict = reservations.value.find(r => 
                        r.spaceId === selectedSpace.value.id && 
                        r.date === form.value.date && 
                        r.status === 'approved'
                    );

                    if (conflict) {
                        return showToast("Este horário já está reservado e aprovado.", "error");
                    }

                    loading.value = true;
                    try {
                        await addDoc(collection(db, "reservations"), {
                            spaceId: selectedSpace.value.id,
                            userId: currentUser.value.id,
                            userName: currentUser.value.name, // Salvando nome para facilitar
                            date: form.value.date,
                            time: form.value.time,
                            guests: form.value.guests,
                            status: 'pending',
                            createdAt: new Date().toISOString()
                        });
                        showToast("Solicitação enviada com sucesso!");
                        showModal.value = false;
                        currentView.value = 'reservations';
                    } catch (e) {
                        showToast("Erro ao salvar: " + e.message, "error");
                    } finally {
                        loading.value = false;
                    }
                };

                // Atualizar Status (Síndico)
                const updateStatus = async (id, status) => {
                    try {
                        const ref = doc(db, "reservations", id);
                        await updateDoc(ref, { status });
                        showToast(`Reserva ${status === 'approved' ? 'aprovada' : 'rejeitada'}.`);
                    } catch (e) {
                        showToast("Erro ao atualizar status", "error");
                    }
                };

                // Deletar Reserva
                const deleteReservation = async (id) => {
                    if(!confirm("Tem certeza que deseja cancelar esta reserva?")) return;
                    try {
                        await deleteDoc(doc(db, "reservations", id));
                        showToast("Reserva cancelada.");
                    } catch (e) {
                        showToast("Erro ao cancelar", "error");
                    }
                };

                // --- PROPRIEDADES COMPUTADAS E AUXILIARES ---
                const myReservations = computed(() => {
                    return reservations.value
                        .filter(r => r.userId === currentUser.value.id)
                        .sort((a,b) => new Date(b.date) - new Date(a.date)); // Mais recentes primeiro
                });
                
                const pendingReservations = computed(() => reservations.value.filter(r => r.status === 'pending'));
                const approvedReservations = computed(() => reservations.value.filter(r => r.status === 'approved'));

                const calculateTotal = computed(() => {
                    if(!selectedSpace.value) return 0;
                    return selectedSpace.value.hourlyRate * 4; // Lógica fixa de 4h para simplificar
                });

                const getReservationsForDay = (day) => {
                    const year = currentDate.value.getFullYear();
                    const month = String(currentDate.value.getMonth() + 1).padStart(2, '0');
                    const dayStr = String(day).padStart(2, '0');
                    const fullDate = `${year}-${month}-${dayStr}`;
                    // Filtra apenas ativas (ignora rejeitadas no calendário)
                    return reservations.value.filter(r => r.date === fullDate && r.status !== 'rejected');
                };

                // Helpers de Navegação e Formatação
                const changeMonth = (delta) => {
                    const newDate = new Date(currentDate.value);
                    newDate.setMonth(newDate.getMonth() + delta);
                    currentDate.value = newDate;
                };

                const selectDate = (day) => {
                    // Clica no dia e já abre o modal com a data
                    const year = currentDate.value.getFullYear();
                    const month = String(currentDate.value.getMonth() + 1).padStart(2, '0');
                    const dayStr = String(day).padStart(2, '0');
                    form.value.date = `${year}-${month}-${dayStr}`;
                    // Abre modal do primeiro espaço (padrão) ou manda selecionar espaço
                    // Aqui apenas setamos a data do form, usuário escolhe o espaço na lista
                };

                const getStatusColor = (s) => s === 'approved' ? '#4CAF50' : s === 'pending' ? '#2196F3' : '#F44336';
                const translateStatus = (s) => {
                    const map = { 'approved': 'Aprovada', 'pending': 'Pendente', 'rejected': 'Rejeitada' };
                    return map[s] || s;
                };
                
                const getSpaceName = (id) => spaces.value.find(s => s.id === id)?.name || 'Espaço Removido';
                const getUserName = (id) => {
                    // Tenta achar na lista mockada ou usa o nome salvo na reserva
                    const u = usersList.find(u => u.id === id);
                    return u ? u.name : 'Morador';
                };
                
                const formatDate = (d) => { if(!d) return ''; const p = d.split('-'); return `${p[2]}/${p[1]}/${p[0]}`; };
                const isToday = (day) => {
                    const today = new Date();
                    return day === today.getDate() && 
                           currentDate.value.getMonth() === today.getMonth() && 
                           currentDate.value.getFullYear() === today.getFullYear();
                };
                
                // Simulação de Login (Dev Helper)
                const toggleUser = () => {
                    if(currentUser.value.type === 'resident') {
                        currentUser.value = usersList[1]; // Vira Admin
                        showToast("Modo Síndico Ativado", "success");
                    } else {
                        currentUser.value = usersList[0]; // Vira Morador
                        currentView.value = 'calendar';
                        showToast("Modo Morador Ativado", "success");
                    }
                };

                // Gerar PDF
                const generateReceipt = (res) => {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    doc.setFillColor(46, 125, 50);
                    doc.rect(0, 0, 210, 40, 'F');
                    
                    doc.setTextColor(255, 255, 255);
                    doc.setFontSize(22);
                    doc.text("CondoSaas", 105, 20, null, null, 'center');
                    doc.setFontSize(12);
                    doc.text("Comprovante Oficial de Reserva", 105, 30, null, null, 'center');
                    
                    doc.setTextColor(0, 0, 0);
                    doc.setFontSize(14);
                    
                    let y = 60;
                    doc.text(`Código da Reserva: #${res.id.substring(0, 8).toUpperCase()}`, 20, y); y += 15;
                    doc.text(`Morador: ${currentUser.value.name}`, 20, y); y += 15;
                    doc.text(`Espaço: ${getSpaceName(res.spaceId)}`, 20, y); y += 15;
                    doc.text(`Data: ${formatDate(res.date)}`, 20, y); y += 15;
                    doc.text(`Horário: ${res.time}`, 20, y); y += 15;
                    doc.text(`Convidados: ${res.guests}`, 20, y); y += 25;
                    
                    doc.setFontSize(16);
                    doc.setTextColor(46, 125, 50);
                    doc.text("STATUS: APROVADO PELO SÍNDICO", 105, y, null, null, 'center');

                    doc.save(`comprovante_${res.date}.pdf`);
                };

                return {
                    currentView, currentUser, spaces, showModal, form, loading, toasts,
                    monthLabel, daysInMonth, paddingDays,
                    myReservations, pendingReservations, approvedReservations, calculateTotal,
                    changeMonth, selectDate, getReservationsForDay, getStatusColor, translateStatus,
                    openBookingModal, confirmBooking, updateStatus, deleteReservation,
                    toggleUser, getSpaceName, getUserName, formatDate, isToday, generateReceipt
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
